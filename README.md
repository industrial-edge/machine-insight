# Machine Insight application example

This guide shows how to use the Industrial Edge application Machine Insight.

- [Machine Insight application example](#machine-insight-application-example)
  - [Description](#description)
    - [Overview](#overview)
    - [General task](#general-task)
  - [Requirements](#requirements)
    - [Prerequisities](#prerequisities)
    - [Used components](#used-components)
    - [TIA Project](#tia-project)
  - [Configuration steps](#configuration-steps)
  - [Usage](#usage)
  - [Documentation](#documentation)
  - [Contribution](#contribution)
  - [Licence and Legal Information](#license-and-legal-information)
  

## Description

### Overview

The application Machine Insight is a **condition monitoring** application which enables easy and efficient **remote diagnosis** of the machines. It provides global comprehensive view of assembly lines and machines, and provides transparency about your machine with worldwide access to machine conditions and events to improve your service processes.

The Machine Insight application enables you to gather different types of diagnostic information: machine status, PLC status, PLC alarms and PLC updates (e.g. program changes, firmware updates). The data is visualized within an intuitive user interface with Gantt chart, notification icons and a log book.

This repository describes how to setup the environment for using the Machine Insight app. The goal is to display all the important device data for the connected PLC.

<img src="docs/graphics/Overview.png" width=600 />

### General task

For the remote diagnostic of a PLC via Machine Insight, it is required that the PLC and the IED are connected to the same network.
Machine Insight collects the device data from the PLC via the SIMATIC S7+ Connector. This connector must be configured via the Common Configurator app. For retrieving the PLC alarms you need to create an asset structure and a dedicated alarm channel within the IIH Essentials app. Since Machine Insight is based on this asset structure, you can configure one PLC dashboard for each asset to show the dedicated device and machine data:

- Machine status (via PLC variable and status mapping)
- Device status (PLC status)
- Device alarms (system/process/security alarms)
- Device updates (PLC changes, e.g. SW program update)

**Important to know:**

- V2.0 only supports S7-1500 PLCs
- Max. 8 connected PLCs per app possible
- SIMATIC S7+ Connector >= V1.4 necessary

## Requirements

###  Prerequisities

- Access to an Industrial Edge Management (IEM) with onboarded Industrial Edge Device (IED)
- Installed system configurators and apps (see list "Used components")
- IED is connected to PLC
- TIA portal project loaded on PLC
- Export of TIA portal project via SIMATIC SCADA Export available (.zip)
- Google Chrome (Version â‰¥ 72)

### Used components

- Industrial Edge Management (IEM) V 1.5.5-2 / V 1.16.11
  - Databus Configurator V 3.0.0
  - Common Connector Configurator V 1.10.1-2
- Industrial Edge Device (IED) simatic-ipc-ied-os-2.1.0-22
  - Databus V 3.0.0
  - SIMATIC S7+ Connector V 1.4.0
  - IIH Essentials V1.11.0
  - Common Configurator V 1.11.1
  - Registry Service V 1.11.0
  - Common Import Converter V 2.2.0
  - Machine Insight V 2.0.0
- PLC: CPU 1515F-2
- TIA Portal V16
- SIMATIC SCADA Export (V16) V2.0

### TIA Project

The used TIA Portal project can be found in the [miscellenous repository](https://github.com/industrial-edge/miscellaneous/tree/main/tank%20application) and is also used for several further application examples.

## Configuration steps

You can find further information about the following steps in the [Configuration](/docs/Installation.md) documentation:

- [Configure Databus](/docs/Installation.md#configure-databus)
- [Configure SIMATIC S7+ Connector](/docs/Installation.md#configure-simatic-s7-connector)
- [Configure IIH Essentials](/docs/Installation.md#configure-iih-essentials)
- [Configure Machine Insight](/docs/Installation.md#configure-machine-insight)

## Usage

Once the configuration is done, you can use the autogenerated dashboards within Machine Insight for remote diagnostic of the connected devices. The app offers a Gantt chart combined with notifications and a log book for each configured asset:

- open the IED web interface
- open the app Machine Insight

![DeviceEntryMachineInsight](/docs/graphics/DeviceEntryMachineInsight.png)

- switch to tab 'My Plant' within the left-side menu
- navigate to the asset which was configured (here 'CPU 1515F-2 PN')
- the dedicated dashboard is shown

![MachineInsightOverviewUI](/docs/graphics/MachineInsightOverviewUI.png)

The Gantt chart displays the following data:

- Machine status via dedicated PLC variable, based on configured status mapping
- Device status of PLC
- Notification icons to indicate alarms (only incoming alarms)

If more than one event occurs in a short span of time, the aggregated data is displayed. You can zoom into the dashboard for detailed view. When hovering on the icon, the tool tip provides the description of the dedicated event.

![MachineInsightExample1](/docs/graphics/MachineInsightExample1.png)

When clicking on 'Details' you get more detailled information about the machine and device status.

When clicking on 'Legend' you get an overview of the machine and device status colors and of the notification icons.

![MachineInsightLegend](/docs/graphics/MachineInsightLegend.png)

The log book provides the two tabs 'Device Alarms' and 'Device Updates'. Under 'Device Alarms' you see the 4 latest incomming alarms from the PLC. Under 'Device Updates' you see the 4 latest updates on the PLC. This covers program updates, hardware updates, firmware updates, textlist updates and safety updates.

When clicking on 'View Log Book' you get the overall list of incoming alarms (history).

![MachineInsightExample2](/docs/graphics/MachineInsightExample2.png)

> Hint: The dashboard is only plotted till the last access of the asset. It does not refresh automatically over time. The polling frequency for the device status is 15 seconds. Status changes will only be visualized with this frequency.

## Documentation
- You can find further documentation and help in the following links
  - [Industrial Edge Hub]( https://iehub.eu1.edge.siemens.cloud/#/documentation)
  - [Industrial Edge Forum]( https://forum.mendix.com/link/space/industrial-edge)
  - [Industrial Edge landing page]( https://new.siemens.com/global/en/products/automation/topic-areas/industrial-edge/simatic-edge.html)
  - [Industrial Edge GitHub page]( https://github.com/industrial-edge)
  - [Industrial Edge documentation page]( https://docs.eu1.edge.siemens.cloud/index.html)
 
## Contribution
 
Thank you for your interest in contributing. Anybody is free to report bugs, unclear documentation, and other problems regarding this repository in the Issues section.
Additionally everybody is free to propose any changes to this repository using Pull Requests.
 
If you haven't previously signed the [Siemens Contributor License Agreement](https://cla-assistant.io/industrial-edge/) (CLA), the system will automatically prompt you to do so when you submit your Pull Request. This can be conveniently done through the CLA Assistant's online platform. Once the CLA is signed, your Pull Request will automatically be cleared and made ready for merging if all other test stages succeed.
 
## License and Legal Information
 
Please read the [Legal information](LICENSE.md).
